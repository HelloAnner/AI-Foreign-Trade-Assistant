import{d as g,u as p,_ as c,B as _,C as S,D as h,w as T,c as k,a as w,b as t,q as m,E as M,l as i,k as r,v as d,G as P,y as x,o as V}from"./index-VgC5M2Xu.js";import{h as u}from"./http-CZPNIr2s.js";const L=async()=>{const{data:e}=await u.get("/settings");return e},U=async e=>{const{data:l}=await u.put("/settings",e);return l},A=async()=>{const{data:e}=await u.post("/settings/test-llm");return e},I=async()=>{const{data:e}=await u.post("/settings/test-smtp");return e},B=async()=>{const{data:e}=await u.post("/settings/test-search");return e},C=g("settings",{state:()=>({loading:!1,data:{llm_base_url:"",llm_api_key:"",llm_model:"",my_company_name:"",my_product_profile:"",smtp_host:"",smtp_port:465,smtp_username:"",smtp_password:"",admin_email:"",rating_guideline:"",search_provider:"",search_api_key:""}}),actions:{async fetchSettings(){const e=p();this.loading=!0;try{const l=await L();l.ok?this.data={...this.data,...l.data}:l.error&&e.pushToast(l.error,"error")}catch(l){console.error("Failed to load settings",l),e.pushToast(l.message,"error")}finally{this.loading=!1}},async saveSettings(e){const l=p();this.loading=!0;try{const o=await U({...this.data,...e});o.ok?(this.data={...this.data,...e},l.pushToast("配置已保存","success")):o.error&&l.pushToast(o.error,"error")}catch(o){console.error("Failed to save settings",o),l.pushToast(o.message,"error")}finally{this.loading=!1}},async testLLM(){const e=p();try{const l=await A();l.ok?e.pushToast(l.data.message||"LLM 测试成功","success"):e.pushToast(l.error||"LLM 测试失败","error")}catch(l){e.pushToast(l.message,"error")}},async testSMTP(){const e=p();try{const l=await I();l.ok?e.pushToast("测试邮件已发送，请检查邮箱","success"):e.pushToast(l.error||"SMTP 测试失败","error")}catch(l){e.pushToast(l.message,"error")}},async testSearch(){const e=p();try{const l=await B();l.ok?e.pushToast("搜索 API 测试成功","success"):e.pushToast(l.error||"搜索测试失败","error")}catch(l){e.pushToast(l.message,"error")}}}}),D={class:"settings-shell"},K={class:"main"},N={class:"card"},R={class:"grid"},E={class:"card"},F={class:"grid"},j={class:"card"},q={class:"grid"},G={class:"grid-two"},O={class:"card"},z={class:"card card--stretch"},H={class:"card"},J={class:"grid"},Q={class:"form-footer"},W=["disabled"],X={__name:"SettingsPage",setup(e){const l=x(),o=C(),{data:f}=_(o),n=S({llm_base_url:"",llm_api_key:"",llm_model:"",my_company_name:"",my_product_profile:"",smtp_host:"",smtp_port:465,smtp_username:"",smtp_password:"",admin_email:"",rating_guideline:"",search_provider:"",search_api_key:""});h(()=>{o.fetchSettings()}),T(f,b=>{b&&Object.assign(n,b)},{immediate:!0});const y=()=>{o.saveSettings({...n})},v=()=>{l.push({name:"home"})};return(b,s)=>(V(),k("div",D,[s[40]||(s[40]=w('<aside class="sidebar" data-v-dfbf8d77><div class="brand" data-v-dfbf8d77><div class="avatar" data-v-dfbf8d77></div><div data-v-dfbf8d77><p class="brand-title" data-v-dfbf8d77>AI外贸助手</p><p class="brand-sub" data-v-dfbf8d77>专业版</p></div></div><nav class="menu" data-v-dfbf8d77><button class="menu-item" data-v-dfbf8d77><span class="material" data-v-dfbf8d77>dashboard</span> Dashboard </button><button class="menu-item" data-v-dfbf8d77><span class="material" data-v-dfbf8d77>group</span> 客户管理 </button><button class="menu-item" data-v-dfbf8d77><span class="material" data-v-dfbf8d77>mail</span> 邮件营销 </button><button class="menu-item" data-v-dfbf8d77><span class="material" data-v-dfbf8d77>bar_chart</span> 数据分析 </button><button class="menu-item menu-item--active" data-v-dfbf8d77><span class="material" data-v-dfbf8d77>settings</span> 全局配置 </button></nav></aside>',1)),t("main",K,[t("header",{class:"page-head"},[s[17]||(s[17]=t("div",null,[t("h1",null,"全局配置"),t("p",null,"配置软件核心参数以确保 AI 助手正常运行。")],-1)),t("button",{class:"ghost",type:"button",onClick:v},[...s[16]||(s[16]=[t("span",{class:"material"},"arrow_back",-1),m(" 返回 ",-1)])])]),t("form",{class:"form",onSubmit:M(y,["prevent"])},[t("section",N,[t("header",null,[s[19]||(s[19]=t("div",null,[t("h2",null,"大模型 (LLM) 设置"),t("p",null,"配置 API 地址与密钥，用于智能分析与内容生成。")],-1)),t("button",{type:"button",class:"chip",onClick:s[0]||(s[0]=(...a)=>i(o).testLLM&&i(o).testLLM(...a))},[...s[18]||(s[18]=[t("span",{class:"material"},"bolt",-1),m(" 测试连接 ",-1)])])]),t("div",R,[t("label",null,[s[20]||(s[20]=t("span",null,"Base URL",-1)),r(t("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>n.llm_base_url=a),type:"text",placeholder:"https://api.example.com/v1"},null,512),[[d,n.llm_base_url]])]),t("label",null,[s[21]||(s[21]=t("span",null,"API Key",-1)),r(t("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>n.llm_api_key=a),type:"text",placeholder:"sk-..."},null,512),[[d,n.llm_api_key]])]),t("label",null,[s[22]||(s[22]=t("span",null,"模型名称",-1)),r(t("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>n.llm_model=a),type:"text",placeholder:"gpt-4o"},null,512),[[d,n.llm_model]])])])]),t("section",E,[s[25]||(s[25]=t("header",null,[t("div",null,[t("h2",null,"我的信息"),t("p",null,"这些信息将用于生成开发信签名与公司介绍。")])],-1)),t("div",F,[t("label",null,[s[23]||(s[23]=t("span",null,"我的公司名称",-1)),r(t("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>n.my_company_name=a),type:"text",placeholder:"例如：环球贸易有限公司"},null,512),[[d,n.my_company_name]])])]),t("label",null,[s[24]||(s[24]=t("span",null,"我的产品 / 服务简介",-1)),r(t("textarea",{"onUpdate:modelValue":s[5]||(s[5]=a=>n.my_product_profile=a),rows:"4",placeholder:"详细描述您的核心产品、优势和主要目标市场。"},null,512),[[d,n.my_product_profile]])])]),t("section",j,[t("header",null,[s[27]||(s[27]=t("div",null,[t("h2",null,"邮件发送 (SMTP) 设置"),t("p",null,"配置用于自动发送跟进邮件的 SMTP 服务器。")],-1)),t("button",{type:"button",class:"chip",onClick:s[6]||(s[6]=(...a)=>i(o).testSMTP&&i(o).testSMTP(...a))},[...s[26]||(s[26]=[t("span",{class:"material"},"send",-1),m(" 发送测试邮件 ",-1)])])]),t("div",q,[t("label",null,[s[28]||(s[28]=t("span",null,"SMTP 服务器",-1)),r(t("input",{"onUpdate:modelValue":s[7]||(s[7]=a=>n.smtp_host=a),type:"text",placeholder:"smtp.example.com"},null,512),[[d,n.smtp_host]])]),t("label",null,[s[29]||(s[29]=t("span",null,"端口",-1)),r(t("input",{"onUpdate:modelValue":s[8]||(s[8]=a=>n.smtp_port=a),type:"number",placeholder:"465"},null,512),[[d,n.smtp_port,void 0,{number:!0}]])]),t("label",null,[s[30]||(s[30]=t("span",null,"邮箱账号",-1)),r(t("input",{"onUpdate:modelValue":s[9]||(s[9]=a=>n.smtp_username=a),type:"text",placeholder:"your@email.com"},null,512),[[d,n.smtp_username]])]),t("label",null,[s[31]||(s[31]=t("span",null,"邮箱密码 / 授权码",-1)),r(t("input",{"onUpdate:modelValue":s[10]||(s[10]=a=>n.smtp_password=a),type:"password",placeholder:"授权码"},null,512),[[d,n.smtp_password]])])])]),t("section",G,[t("div",O,[s[33]||(s[33]=t("header",null,[t("div",null,[t("h2",null,"系统设置"),t("p",null,"全局通知与默认管理员设置。")])],-1)),t("label",null,[s[32]||(s[32]=t("span",null,"管理员邮箱",-1)),r(t("input",{"onUpdate:modelValue":s[11]||(s[11]=a=>n.admin_email=a),type:"email",placeholder:"用于接收系统通知"},null,512),[[d,n.admin_email]])])]),t("div",z,[s[34]||(s[34]=t("header",null,[t("div",null,[t("h2",null,"客户评级标准"),t("p",null,"以自然语言描述您的 A/B/C 客户定义。")])],-1)),r(t("textarea",{"onUpdate:modelValue":s[12]||(s[12]=a=>n.rating_guideline=a),rows:"8",placeholder:`例如：
A级：明确表达采购意向，有具体需求和预算；
B级：对产品感兴趣，正在评估供应商；
C级：暂无明确需求，仅收集资料。`},null,512),[[d,n.rating_guideline]])])]),t("section",H,[t("header",null,[s[36]||(s[36]=t("div",null,[t("h2",null,"搜索 API 设置"),t("p",null,"配置用于外部情报搜索的 API。")],-1)),t("button",{type:"button",class:"chip",onClick:s[13]||(s[13]=(...a)=>i(o).testSearch&&i(o).testSearch(...a))},[...s[35]||(s[35]=[t("span",{class:"material"},"travel_explore",-1),m(" 测试搜索 ",-1)])])]),t("div",J,[t("label",null,[s[38]||(s[38]=t("span",null,"搜索提供商",-1)),r(t("select",{"onUpdate:modelValue":s[14]||(s[14]=a=>n.search_provider=a)},[...s[37]||(s[37]=[t("option",{value:""},"未配置（直连模式）",-1),t("option",{value:"serpapi"},"SerpAPI",-1)])],512),[[P,n.search_provider]])]),t("label",null,[s[39]||(s[39]=t("span",null,"API Key",-1)),r(t("input",{"onUpdate:modelValue":s[15]||(s[15]=a=>n.search_api_key=a),type:"text",placeholder:"SerpAPI Key"},null,512),[[d,n.search_api_key]])])])]),t("footer",Q,[t("button",{class:"primary",type:"submit",disabled:i(o).loading},"保存配置",8,W)])],32)])]))}},$=c(X,[["__scopeId","data-v-dfbf8d77"]]);export{$ as default};
