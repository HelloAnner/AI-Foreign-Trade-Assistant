import{_ as x,u as H,a as J,c as p,o as d,b as s,d as Q,n as G,e as j,t as y,f as X,r as W,g as Y,h as k,i as A,j as V,k as I,w as K,l as T,m as _,p as U,q as h,s as o,v as f,T as R,x as S,F as L,y as E,z as Z,A as tt,B as st}from"./index-CNRjy-lW.js";import{h as b}from"./http-CZPNIr2s.js";const et={class:"shell"},at={class:"sidebar"},ot={class:"menu"},lt={class:"main"},nt={class:"progress"},it={class:"progress-top"},rt={class:"progress-bar"},ut={class:"headline"},dt={class:"content"},ct={class:"footer"},pt={__name:"FlowLayout",props:{step:{type:Number,default:1},total:{type:Number,default:5},title:{type:String,default:""},subtitle:{type:String,default:""},progress:{type:Number,default:0}},setup(a){const t=H(),l=J(),n=e=>{!e||l.name===e||t.push({name:e})},r=e=>l.name===e;return(e,i)=>(d(),p("div",et,[s("aside",at,[i[5]||(i[5]=s("div",{class:"brand"},[s("div",{class:"avatar"}),s("div",null,[s("p",{class:"brand-title"},"AI外贸助手"),s("p",{class:"brand-sub"},"智能客户开发")])],-1)),s("nav",ot,[s("button",{type:"button",class:G(["menu-item",{"menu-item--active":r("home")}]),onClick:i[0]||(i[0]=v=>n("home"))},[...i[2]||(i[2]=[s("span",{class:"material"},"search",-1),j(" 客户开发 ",-1)])],2),i[4]||(i[4]=Q('<button class="menu-item" type="button" disabled data-v-c3d5c79a><span class="material" data-v-c3d5c79a>group</span> 客户管理 </button><button class="menu-item" type="button" disabled data-v-c3d5c79a><span class="material" data-v-c3d5c79a>mail</span> 邮件营销 </button><button class="menu-item" type="button" disabled data-v-c3d5c79a><span class="material" data-v-c3d5c79a>bar_chart</span> 数据分析 </button>',3)),s("button",{type:"button",class:G(["menu-item",{"menu-item--active":r("settings")}]),onClick:i[1]||(i[1]=v=>n("settings"))},[...i[3]||(i[3]=[s("span",{class:"material"},"settings",-1),j(" 全局配置 ",-1)])],2)])]),s("main",lt,[s("div",nt,[s("div",it,[s("p",null,"当前进度："+y(a.step)+"/"+y(a.total),1)]),s("div",rt,[s("div",{class:"progress-fill",style:X({width:`${Math.min(100,Math.max(0,a.progress))}%`})},null,4)])]),s("header",ut,[s("h1",null,y(a.title),1),s("p",null,y(a.subtitle),1)]),s("section",dt,[W(e.$slots,"default",{},void 0)]),s("footer",ct,[W(e.$slots,"footer",{},void 0)])])]))}},M=x(pt,[["__scopeId","data-v-c3d5c79a"]]),mt=async a=>{const{data:t}=await b.post("/companies/resolve",{query:a});return t},yt=async a=>{const{data:t}=await b.post("/companies",a);return t},ht=async(a,t)=>{const{data:l}=await b.put(`/companies/${a}`,t);return l},vt=async(a,t)=>{const{data:l}=await b.post(`/companies/${a}/contacts`,{contacts:t});return l},ft=async a=>{const{data:t}=await b.post(`/companies/${a}/grade/suggest`);return t},_t=async(a,t)=>{const{data:l}=await b.post(`/companies/${a}/grade/confirm`,t);return l},gt=async a=>{const{data:t}=await b.post(`/companies/${a}/analysis`);return t},bt=async(a,t)=>{const{data:l}=await b.put(`/companies/${a}/analysis`,t);return l},wt=async a=>{const{data:t}=await b.post(`/companies/${a}/email-draft`);return t},$t=async(a,t)=>{const{data:l}=await b.put(`/emails/${a}`,t);return l},kt=async(a,t,l="")=>{const{data:n}=await b.post(`/companies/${a}/followup/first-save`,{email_id:t,notes:l});return n},Ct=async a=>{const{data:t}=await b.post("/followups/schedule",a);return t},F=Y("flow",{state:()=>({step:1,query:"",resolving:!1,resolveResult:null,contacts:[],summary:"",country:"",website:"",customerId:null,gradeSuggestion:null,gradeFinal:null,analysis:null,emailDraft:null,followupId:null,scheduledTask:null,loading:{grade:!1,analysis:!1,email:!1,followup:!1,schedule:!1}}),actions:{resetFlow(){this.step=1,this.query="",this.resolving=!1,this.resolveResult=null,this.contacts=[],this.summary="",this.country="",this.website="",this.customerId=null,this.gradeSuggestion=null,this.gradeFinal=null,this.analysis=null,this.emailDraft=null,this.followupId=null,this.scheduledTask=null,this.loading={grade:!1,analysis:!1,email:!1,followup:!1,schedule:!1}},async startResolve(a){const t=k();this.resolving=!0,this.query=a;try{const n=(await mt(a)).data||{};if(this.resolveResult=n,this.contacts=(n.contacts||[]).map(r=>({...r})),this.summary=n.summary||"",this.country=n.country||"",this.website=n.website||"",n.customer_id){this.customerId=n.customer_id;const r=(n.grade||"").toUpperCase();r&&r!=="UNKNOWN"?this.gradeFinal={grade:r,reason:n.grade_reason||""}:this.gradeFinal=null,this.analysis=n.analysis?{...n.analysis}:null,this.emailDraft=n.email_draft?{...n.email_draft}:null,this.followupId=n.followup_id||null,this.scheduledTask=n.scheduled_task||null,this.step=Math.max(1,n.last_step||1)}else this.customerId=null,this.gradeFinal=null,this.analysis=null,this.emailDraft=null,this.followupId=null,this.scheduledTask=null,this.step=1;this.gradeSuggestion=null}catch(l){t.pushToast(l.message,"error")}finally{this.resolving=!1}},async saveCompany(a){const t=k(),l={name:a.name,website:a.website||this.website,country:a.country||this.country,summary:a.summary||this.summary,contacts:this.contacts,source_json:this.resolveResult||{}};try{if(this.customerId)await ht(this.customerId,l),t.pushToast("客户信息已更新","success");else{const n=await yt(l);this.customerId=n.data.customer_id,t.pushToast("客户信息已保存","success")}this.website=l.website,this.country=l.country,this.summary=l.summary,this.step=Math.max(this.step,2),this.resolveResult={...this.resolveResult&&typeof this.resolveResult=="object"?this.resolveResult:{},customer_id:this.customerId,name:l.name,website:l.website,country:l.country,summary:l.summary,contacts:(l.contacts||[]).map(n=>({...n})),last_step:Math.max(this.step,2)}}catch(n){t.pushToast(n.message,"error")}},async updateContacts(a){const t=k();if(this.contacts=a,!!this.customerId)try{await vt(this.customerId,a),t.pushToast("联系人已更新","success")}catch(l){t.pushToast(l.message,"error")}},async fetchGrade(){if(!this.customerId)return;const a=k();this.loading.grade=!0;try{const t=await ft(this.customerId);this.gradeSuggestion=t.data}catch(t){a.pushToast(t.message,"error")}finally{this.loading.grade=!1}},async confirmGrade(a,t=""){if(!this.customerId)return;const l=k();try{await _t(this.customerId,{grade:a,reason:t}),this.gradeFinal={grade:a,reason:t},a==="A"?this.step=3:(this.step=5,l.pushToast("非 A 级客户，流程已归档","info"))}catch(n){l.pushToast(n.message,"error")}},async fetchAnalysis(){if(!this.customerId)return;const a=k();this.loading.analysis=!0;try{const t=await gt(this.customerId);this.analysis=t.data,this.step=3}catch(t){a.pushToast(t.message,"error")}finally{this.loading.analysis=!1}},async persistAnalysis(){if(!this.customerId||!this.analysis)return;const a=k();try{await bt(this.customerId,{core_business:this.analysis.core_business,pain_points:this.analysis.pain_points,my_entry_points:this.analysis.my_entry_points,full_report:this.analysis.full_report}),a.pushToast("分析内容已更新","success")}catch(t){a.pushToast(t.message,"error")}},async generateEmail(){if(!this.customerId)return;const a=k();this.loading.email=!0;try{const t=await wt(this.customerId);this.emailDraft=t.data,this.step=4}catch(t){a.pushToast(t.message,"error")}finally{this.loading.email=!1}},async saveInitialFollowup(a=""){if(!this.customerId||!this.emailDraft)return;const t=k();this.loading.followup=!0;try{await $t(this.emailDraft.email_id,{subject:this.emailDraft.subject,body:this.emailDraft.body});const l=await kt(this.customerId,this.emailDraft.email_id,a);this.followupId=l.data.followup_id,this.step=5,t.pushToast("首次跟进记录已保存","success")}catch(l){t.pushToast(l.message,"error")}finally{this.loading.followup=!1}},async createSchedule(a){if(!this.customerId||!this.emailDraft)return;const t=k();this.loading.schedule=!0;try{const l=await Ct({customer_id:this.customerId,context_email_id:this.emailDraft.email_id,delay_days:a});this.scheduledTask=l.data,t.pushToast(`已设置 ${a} 天后的自动跟进`,"success")}catch(l){t.pushToast(l.message,"error")}finally{this.loading.schedule=!1}}}}),It={class:"cards"},St={class:"query"},xt=["disabled"],Tt=["disabled"],Ft={key:"result",class:"result"},Dt={class:"card"},Nt={class:"grid"},Vt={class:"full"},At={key:0,class:"candidates"},Ut=["onClick"],Rt={class:"card"},Mt={key:0,class:"contacts"},qt=["onUpdate:modelValue"],Bt=["onUpdate:modelValue"],Gt=["onUpdate:modelValue"],jt=["onUpdate:modelValue"],Lt={class:"key"},Et=["onUpdate:modelValue"],Pt=["onClick"],zt={key:1,class:"placeholder"},Ot={class:"footer-actions"},Kt=["disabled"],Wt={__name:"StepOne",setup(a){const t=F(),l=A("flowNav",{goNext:()=>{}}),n=V(t.query),r=V({name:"",website:"",country:"",summary:""}),e=V([]),i=I(()=>t.resolveResult?.candidates||[]),v=I(()=>!!t.resolveResult),g=I(()=>{if(!v.value)return!1;const m=(n.value||"").trim(),u=(t.query||"").trim();return m!==u}),P=I(()=>t.resolving?"分析中…":g.value?"开始分析":v.value?"下一步":"开始分析"),q=I(()=>t.resolving?!0:g.value?!n.value:v.value?!r.value.name:!n.value);K(()=>t.resolveResult,m=>{if(!m){r.value={name:t.query||"",website:"",country:"",summary:""},e.value=[];return}r.value={name:m.name||t.query||"",website:m.website||"",country:m.country||"",summary:m.summary||""},e.value=(m.contacts||[]).map(u=>({...u}))},{immediate:!0}),K(()=>t.contacts,m=>{!m||!m.length||(e.value=m.map(u=>({...u})))});const B=async()=>{!n.value||t.resolving||await t.startResolve(n.value)},D=async()=>{r.value.name&&(t.contacts=e.value.map(m=>({...m})),await t.saveCompany({...r.value}),l.goNext?.())},N=async()=>{t.resolving||(g.value||!v.value?await B():await D())},z=()=>{e.value.push({name:"",title:"",email:"",source:"",is_key:e.value.length===0})},w=m=>{e.value.splice(m,1)},C=m=>{m&&(r.value.website=m)};return(m,u)=>(d(),T(M,{step:1,total:5,title:"Step 1: 智能信息获取与聚合",subtitle:"请核对并校准以下 AI 获取的信息，确保其准确性。",progress:20},{footer:_(()=>[s("div",Ot,[u[13]||(u[13]=s("button",{class:"ghost",type:"button",disabled:!0},"返回上一步",-1)),s("button",{class:"primary",type:"button",onClick:D,disabled:!r.value.name}," 保存并继续 ",8,Kt)])]),default:_(()=>[s("section",It,[s("div",St,[h(s("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>n.value=c),disabled:o(t).resolving,type:"text",placeholder:"输入客户公司全名或官网地址"},null,8,xt),[[f,n.value]]),s("button",{class:G(v.value&&!o(t).resolving?"success":"primary"),disabled:q.value,onClick:N},y(P.value),11,Tt)]),U(R,{name:"fade"},{default:_(()=>[o(t).resolveResult?(d(),p("div",Ft,[s("section",Dt,[u[10]||(u[10]=s("header",null,[s("h2",null,"公司信息"),s("p",null,"AI 自动抓取的公司基础信息。")],-1)),s("div",Nt,[s("label",null,[u[5]||(u[5]=s("span",null,"公司名称",-1)),h(s("input",{"onUpdate:modelValue":u[1]||(u[1]=c=>r.value.name=c),type:"text",placeholder:"如：环球贸易有限公司"},null,512),[[f,r.value.name]])]),s("label",null,[u[6]||(u[6]=s("span",null,"公司官网",-1)),h(s("input",{"onUpdate:modelValue":u[2]||(u[2]=c=>r.value.website=c),type:"text",placeholder:"https://example.com"},null,512),[[f,r.value.website]])]),s("label",null,[u[7]||(u[7]=s("span",null,"国家 / 地区",-1)),h(s("input",{"onUpdate:modelValue":u[3]||(u[3]=c=>r.value.country=c),type:"text",placeholder:"United States"},null,512),[[f,r.value.country]])])]),s("label",Vt,[u[8]||(u[8]=s("span",null,"AI 摘要",-1)),h(s("textarea",{"onUpdate:modelValue":u[4]||(u[4]=c=>r.value.summary=c),rows:"4",placeholder:"公司业务概览"},null,512),[[f,r.value.summary]])]),i.value.length?(d(),p("div",At,[u[9]||(u[9]=s("h3",null,"候选官网列表",-1)),s("ul",null,[(d(!0),p(L,null,E(i.value,c=>(d(),p("li",{key:c.url},[s("button",{type:"button",class:"link",onClick:O=>C(c.url)},y(c.url),9,Ut),s("small",null,y(c.reason),1)]))),128))])])):S("",!0)]),s("section",Rt,[u[12]||(u[12]=s("header",null,[s("h2",null,"潜在联系人"),s("p",null,"AI 识别到的潜在业务联系人，可继续补充。")],-1)),s("div",{class:"contacts-header"},[s("button",{class:"ghost",type:"button",onClick:z},"新增联系人")]),e.value.length?(d(),p("div",Mt,[(d(!0),p(L,null,E(e.value,(c,O)=>(d(),p("div",{key:O,class:"contact-row"},[h(s("input",{"onUpdate:modelValue":$=>c.name=$,type:"text",placeholder:"联系人姓名"},null,8,qt),[[f,c.name]]),h(s("input",{"onUpdate:modelValue":$=>c.title=$,type:"text",placeholder:"职位"},null,8,Bt),[[f,c.title]]),h(s("input",{"onUpdate:modelValue":$=>c.email=$,type:"email",placeholder:"邮箱地址"},null,8,Gt),[[f,c.email]]),h(s("input",{"onUpdate:modelValue":$=>c.source=$,type:"text",placeholder:"社交媒体 / 来源"},null,8,jt),[[f,c.source]]),s("label",Lt,[h(s("input",{type:"checkbox","onUpdate:modelValue":$=>c.is_key=$},null,8,Et),[[Z,c.is_key]]),u[11]||(u[11]=j(" 重点联系人 ",-1))]),s("button",{class:"ghost",type:"button",onClick:$=>w(O)},"删除",8,Pt)]))),128))])):(d(),p("div",zt,"暂无联系人，试着手动添加一个关键联系人。"))])])):S("",!0)]),_:1})])]),_:1}))}},Ht=x(Wt,[["__scopeId","data-v-85c1a700"]]),Jt={class:"card"},Qt={key:0,class:"placeholder"},Xt={key:1,class:"content"},Yt=["disabled"],Zt={key:"grade",class:"result"},ts={class:"grade"},ss={class:"reason"},es={class:"actions"},as={key:0,class:"status"},os={key:0},ls={class:"footer-actions"},ns=["disabled"],is={__name:"StepTwo",setup(a){const t=F(),l=A("flowNav",{}),n=r=>{const e=t.gradeSuggestion?.reason||"";t.confirmGrade(r,e)};return(r,e)=>(d(),T(M,{step:2,total:5,title:"Step 2: AI 辅助客户价值评级",subtitle:"结合评级规则自动给出 A/B/C 建议，可人工调整结果。",progress:40},{footer:_(()=>[s("div",ls,[s("button",{class:"ghost",type:"button",onClick:e[4]||(e[4]=i=>o(l).goPrev?.())},"返回上一步"),s("button",{class:"primary",type:"button",disabled:!o(t).gradeFinal||o(t).gradeFinal.grade==="C"||o(t).gradeFinal.grade==="B",onClick:e[5]||(e[5]=()=>o(l).goNext?.())}," 保存并继续 ",8,ns)])]),default:_(()=>[s("section",Jt,[o(t).customerId?(d(),p("div",Xt,[s("button",{class:"primary",disabled:o(t).loading.grade,onClick:e[0]||(e[0]=(...i)=>o(t).fetchGrade&&o(t).fetchGrade(...i))},y(o(t).loading.grade?"评估中…":o(t).gradeSuggestion?"重新评估":"获取 AI 评级"),9,Yt),U(R,{name:"fade"},{default:_(()=>[o(t).gradeSuggestion?(d(),p("div",Zt,[s("p",ts,[e[6]||(e[6]=j("AI 建议等级：",-1)),s("strong",null,y(o(t).gradeSuggestion.suggested_grade),1)]),s("p",ss,"理由："+y(o(t).gradeSuggestion.reason),1),s("div",es,[s("button",{class:"primary",type:"button",onClick:e[1]||(e[1]=i=>n("A"))},"确认 A 级"),s("button",{class:"ghost",type:"button",onClick:e[2]||(e[2]=i=>n("B"))},"调整为 B 级"),s("button",{class:"ghost",type:"button",onClick:e[3]||(e[3]=i=>n("C"))},"调整为 C 级")])])):S("",!0)]),_:1}),o(t).gradeFinal?(d(),p("div",as,[s("span",null,"当前等级："+y(o(t).gradeFinal.grade),1),o(t).gradeFinal.reason?(d(),p("small",os,"理由："+y(o(t).gradeFinal.reason),1)):S("",!0)])):S("",!0)])):(d(),p("div",Qt,"请先完成 Step 1 并保存客户信息。"))])]),_:1}))}},rs=x(is,[["__scopeId","data-v-6dbf747d"]]),us={class:"card"},ds={key:0,class:"placeholder"},cs={key:1,class:"content"},ps=["disabled"],ms={key:"analysis",class:"analysis-form"},ys={class:"footer-actions"},hs=["disabled"],vs={__name:"StepThree",setup(a){const t=F(),l=A("flowNav",{}),n=async()=>{await t.persistAnalysis(),t.step=Math.max(t.step,4),l.goNext?.()};return(r,e)=>(d(),T(M,{step:3,total:5,title:"Step 3: 生成产品切入点分析",subtitle:"结合客户业务与我方优势，生成可编辑的切入报告。",progress:60},{footer:_(()=>[s("div",ys,[s("button",{class:"ghost",type:"button",onClick:e[5]||(e[5]=i=>o(l).goPrev?.())},"返回上一步"),s("button",{class:"primary",type:"button",onClick:n,disabled:!o(t).analysis}," 保存并继续 ",8,hs)])]),default:_(()=>[s("section",us,[o(t).step<3?(d(),p("div",ds,"请先确认客户为 A 级并完成前两步。")):(d(),p("div",cs,[s("button",{class:"primary",disabled:o(t).loading.analysis,onClick:e[0]||(e[0]=(...i)=>o(t).fetchAnalysis&&o(t).fetchAnalysis(...i))},y(o(t).loading.analysis?"生成中…":o(t).analysis?"重新生成":"生成分析"),9,ps),U(R,{name:"fade"},{default:_(()=>[o(t).analysis?(d(),p("div",ms,[s("label",null,[e[6]||(e[6]=s("span",null,"核心业务",-1)),h(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=i=>o(t).analysis.core_business=i),rows:"3"},null,512),[[f,o(t).analysis.core_business]])]),s("label",null,[e[7]||(e[7]=s("span",null,"潜在痛点",-1)),h(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>o(t).analysis.pain_points=i),rows:"3"},null,512),[[f,o(t).analysis.pain_points]])]),s("label",null,[e[8]||(e[8]=s("span",null,"我方切入点",-1)),h(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=i=>o(t).analysis.my_entry_points=i),rows:"3"},null,512),[[f,o(t).analysis.my_entry_points]])]),s("label",null,[e[9]||(e[9]=s("span",null,"完整报告",-1)),h(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=i=>o(t).analysis.full_report=i),rows:"5"},null,512),[[f,o(t).analysis.full_report]])])])):S("",!0)]),_:1})]))])]),_:1}))}},fs=x(vs,[["__scopeId","data-v-d5743f0b"]]),_s={class:"card"},gs={key:0,class:"placeholder"},bs={key:1,class:"content"},ws=["disabled"],$s={key:"email",class:"email-form"},ks={class:"footer-actions"},Cs=["disabled"],Is={__name:"StepFour",setup(a){const t=F(),l=A("flowNav",{}),n=async()=>{await t.saveInitialFollowup(),t.step=Math.max(t.step,5),l.goNext?.()};return(r,e)=>(d(),T(M,{step:4,total:5,title:"Step 4: 生成个性化开发信",subtitle:"生成开发信草稿，确认后保存为首次跟进记录。",progress:80},{footer:_(()=>[s("div",ks,[s("button",{class:"ghost",type:"button",onClick:e[3]||(e[3]=i=>o(l).goPrev?.())},"返回上一步"),s("button",{class:"primary",type:"button",disabled:o(t).loading.followup||!o(t).emailDraft,onClick:n},y(o(t).loading.followup?"保存中…":"保存并继续"),9,Cs)])]),default:_(()=>[s("section",_s,[o(t).step<4?(d(),p("div",gs,"请先完成切入点分析。")):(d(),p("div",bs,[s("button",{class:"primary",disabled:o(t).loading.email,onClick:e[0]||(e[0]=(...i)=>o(t).generateEmail&&o(t).generateEmail(...i))},y(o(t).loading.email?"生成中…":o(t).emailDraft?"重新生成":"生成开发信"),9,ws),U(R,{name:"fade"},{default:_(()=>[o(t).emailDraft?(d(),p("div",$s,[s("label",null,[e[4]||(e[4]=s("span",null,"邮件标题",-1)),h(s("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o(t).emailDraft.subject=i),type:"text"},null,512),[[f,o(t).emailDraft.subject]])]),s("label",null,[e[5]||(e[5]=s("span",null,"邮件正文",-1)),h(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>o(t).emailDraft.body=i),rows:"10"},null,512),[[f,o(t).emailDraft.body]])])])):S("",!0)]),_:1})]))])]),_:1}))}},Ss=x(Is,[["__scopeId","data-v-f5a2ed2f"]]),xs={class:"card"},Ts={key:0,class:"placeholder"},Fs={key:1,class:"content"},Ds={class:"quick-buttons"},Ns=["disabled","onClick"],Vs={key:0,class:"info"},As={class:"footer-actions"},Us={__name:"StepFive",setup(a){const t=F(),l=A("flowNav",{}),n=[3,7,14],r=i=>{t.createSchedule(i)},e=i=>i?new Date(i).toLocaleString():"";return(i,v)=>(d(),T(M,{step:5,total:5,title:"Step 5: 设置自动化邮件跟进",subtitle:"选择跟进时间，系统将在到期时自动生成并发送邮件。",progress:100},{footer:_(()=>[s("div",As,[s("button",{class:"ghost",type:"button",onClick:v[0]||(v[0]=g=>o(l).goPrev?.())},"返回上一步"),s("button",{class:"primary",type:"button",onClick:v[1]||(v[1]=(...g)=>o(t).resetFlow&&o(t).resetFlow(...g))},"完成并开始下一个")])]),default:_(()=>[s("section",xs,[o(t).step<5?(d(),p("div",Ts,"请先保存首次跟进记录。")):(d(),p("div",Fs,[s("div",Ds,[(d(),p(L,null,E(n,g=>s("button",{key:g,class:"ghost",disabled:o(t).loading.schedule,onClick:P=>r(g)},y(g)+" 天后跟进",9,Ns)),64))]),o(t).scheduledTask?(d(),p("div",Vs," 已设置任务，计划发送时间："+y(e(o(t).scheduledTask.due_at)),1)):S("",!0)]))])]),_:1}))}},Rs=x(Us,[["__scopeId","data-v-6de79a83"]]),Ms={class:"layout"},qs={class:"carousel"},Bs=["disabled"],Gs={class:"viewport"},js=["disabled"],Ls={class:"indicator"},Es={class:"dots"},Ps=["disabled","onClick"],zs={__name:"MainFlow",setup(a){const t=H(),l=F(),n=[{id:1,component:Ht},{id:2,component:rs},{id:3,component:fs},{id:4,component:Ss},{id:5,component:Rs}],r=V(0),e=V("forward"),i=I(()=>Math.max(l.step-1,0)),v=I(()=>r.value<i.value),g=I(()=>e.value==="forward"?"slide-left":"slide-right");st("flowNav",{goPrev:q,goNext:B,goTo:D}),K(()=>l.step,w=>{const C=Math.max(0,w-1);C!==r.value&&(e.value=C>r.value?"forward":"backward",r.value=C)});function q(){r.value!==0&&(e.value="backward",r.value-=1,N())}function B(){v.value&&(e.value="forward",r.value+=1,N())}function D(w){w>i.value||(e.value=w>r.value?"forward":"backward",r.value=w,N())}function N(){const w=r.value+1;w>l.step&&(l.step=w)}const z=()=>{t.push({name:"settings"})};return(w,C)=>(d(),p("div",Ms,[s("header",{class:"topbar"},[C[0]||(C[0]=s("div",{class:"title"},"AI 外贸客户开发助手",-1)),s("button",{class:"settings-btn",onClick:z},"设置")]),s("div",qs,[s("button",{class:"nav-btn",disabled:r.value===0,onClick:q},"‹",8,Bs),s("div",Gs,[U(R,{name:g.value,mode:"out-in"},{default:_(()=>[(d(),T(tt(n[r.value].component),{key:n[r.value].id}))]),_:1},8,["name"])]),s("button",{class:"nav-btn",disabled:!v.value,onClick:B},"›",8,js)]),s("footer",Ls,[s("span",null,"Step "+y(r.value+1)+" / "+y(n.length),1),s("div",Es,[(d(),p(L,null,E(n,(m,u)=>s("button",{key:m.id,class:G(["dot",{"dot--active":u===r.value,"dot--unlock":u<i.value}]),disabled:u>i.value,onClick:c=>D(u)},null,10,Ps)),64))])])]))}},Ws=x(zs,[["__scopeId","data-v-4d8710a6"]]);export{Ws as default};
